<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8">
		<title>Guide Symfony Pr√™t Travaux - Tablo</title>
		<link
		rel="stylesheet" href="styles.css">
		<!-- Prism.js pour la coloration syntaxique -->
		<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-okaidia.min.css" rel="stylesheet"/>
	 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
		<!-- D√©pendances dans l'ordre correct -->
		 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-markup-templating.min.js"></script>
		 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
		 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-php.min.js"></script>
		 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
		 <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
	</head>
	<body>
		<h1>üèóÔ∏è Guide de Construction d'une Application de Gestion de Pr√™t Travaux avec Symfony 7.3</h1>
		<div class="danger">Attention : Si tu veux vraiment retenir le code tape le! pas de copier-coller!!! J'ai pris le temps de metre le minimum de code √† taper</div>
		<div id="sommaire">
			<h2>üìö Sommaire</h2>
			<ol>
				<li><a href="#part0">Partie 0 - Pr√©paration de l'environnement Docker</a></li>
				<li><a href="#part1">Partie 1 - Configuration initiale et authentification</a></li>
				<li><a href="#part2">Partie 2 - Impl√©mentation du tableau interactif</a></li>
				<li><a href="#part3">Partie 3 - Am√©liorations et tests</a></li>
			</ol>
		</div>

		<div id="part0" class="part">
			<h2>üê≥ Partie 0: Cr√©ation de l'application Symfony</h2>
			<p>Installation des outils de debs par
				<code>cd ~ && git clone https://github.com/cadot-eu/debs.git && ./installdebs</code>
			</p>

			<h3>üöÄ Commandes essentielles</h3>

			<h4>1. Le docker cr√©era un symfony automatiquement</h4>
			<pre><code>dc up -d && dlogs tablo</code></pre>
			<p>il faut attendre d'avoir Command line: 'apache2 -E /dev/stderr -D FOREGROUND' pour que symfony soit install√© et le docker pr√™t, cela peut prendre 2-3 mn quand tu le vois CTRL+C pour quitter dlogs</p>

			<div class="explanation">
				<h5>üê≥ D√©marrage automatique du conteneur Docker</h5>
				<p>Le docker utilise une image avec Symfony pr√©-install√© :</p>
				<ul>
					<li>
						<strong>dc up -d :</strong>
						D√©marre le conteneur en arri√®re-plan</li>
					<li>
						<strong>dlogs tablo :</strong>
						Affiche les logs en temps r√©el</li>
					<li>
						<strong>Installation compl√®te :</strong>
						Tous les bundles essentiels (Twig, Doctrine, Security)</li>
					<li>
						<strong>Structure pr√™te :</strong>
						bin/console automatiquement cr√©√©</li>
				</ul>
				<p>
					<strong>Attendre le message Apache :</strong>
					Indique que Symfony est enti√®rement op√©rationnel</p>
			</div>

			<h4>2. On voit notre docker</h4>
			<pre><code>docker ps</code></pre>

			<div class="explanation">
				<h5>üîç Inspection des conteneurs actifs</h5>
				<p>La commande
					<code>docker ps</code>
					affiche :</p>
				<ul>
					<li>
						<strong>CONTAINER ID :</strong>
						Pour tuer le docker (docker kill num√©ro) ou avoir des infos (docker inspect num√©ro)</li>
					<li>
						<strong>Image :</strong>
						cadoteu/symfony5-6-runsite (docker avec tout dedans pour faire tourner Symfony)</li>
					<li>
						<strong>STATUS :</strong>
						Pour voir si le docker tourne (Up)</li>
					<li>
						<strong>PORTS :</strong>
						0.0.0.0:8080->80 et 0.0.0.0:4443->443</li>
					<li>
						<strong>NAME :</strong>
						tablo (nom du conteneur)</li>
				</ul>
				<p>
					<strong>Acc√®s web :</strong>
					http://localhost:8080 ou https://localhost:4443</p>
			</div>

			<h4>3. Acc√®s conteneur</h4>
			<pre><code>dbash tablo</code></pre>

			<div class="explanation">
				<h5>üñ•Ô∏è Shell interactif dans le conteneur</h5>
				<p>dbash permet d'entrer dans le conteneur :</p>
				<ul>
					<li>
						<strong>Shell bash :</strong>
						Ligne de commande compl√®te</li>
					<li>
						<strong>Environnement Symfony :</strong>
						Tous les outils disponibles</li>
					<li>
						<strong>sc :</strong>
						Raccourci pour php bin/console</li>
					<li>
						<strong>Composer :</strong>
						Gestionnaire de d√©pendances PHP</li>
				</ul>
			</div>

			<h4>4. V√©rification de l'installation</h4>
			<pre><code>sc list</code></pre>

			<div class="explanation">
				<h5>üìù Commandes Symfony disponibles</h5>
				<p>sc est le raccourci de php bin/console :</p>
				<ul>
					<li>
						<strong>sc list :</strong>
						Liste des commandes disponibles</li>
					<li>
						<strong>sc make:controller :</strong>
						Cr√©e un contr√¥leur</li>
					<li>
						<strong>sc make:entity :</strong>
						Cr√©e une entit√© Doctrine</li>
					<li>
						<strong>sc doctrine:schema:update -f :</strong>
						Met √† jour la base</li>
					<li>
						<strong>sc doctrine:fixtures:load :</strong>
						Charge les fixtures</li>
					<li>
						<strong>sc cache:clear :</strong>
						Vide le cache</li>
					<li>
						<strong>sc debug:router :</strong>
						Affiche les routes</li>
				</ul>
			</div>

			<h4>5. Sortir du conteneur</h4>
			<pre><code>exit</code></pre>

			<div class="explanation">
				<h5>üö™ Retour √† l'environnement local</h5>
				<p>La commande
					<code>exit</code>
					ferme la session dans le conteneur et retourne √† votre terminal local.</p>
			</div>

			<h4>6. Configuration .env</h4>
			<p>on ouvre vscode sur notre projet
				<pre><code>cd project-tablo && code .</code></pre>
			</p>
			<p>On ajoute dans .env.local (il faut le cr√©er)</p>
			<pre><code>APP_ENV=dev
			PRET_TOTAL=34000</code></pre>

			<div class="explanation">
				<h5>‚öôÔ∏è Configuration d'environnement</h5>
				<p>Fichiers d'environnement Symfony :</p>
				<ul>
					<li>
						<strong>.env :</strong>
						Variables par d√©faut (versionn√©es)</li>
					<li>
						<strong>.env.local :</strong>
						Variables locales (non versionn√©es)</li>
					<li>
						<strong>Priorit√© :</strong>
						.env.local remplace .env</li>
					<li>
						<strong>APP_ENV=dev :</strong>
						Mode d√©veloppement</li>
					<li>
						<strong>PRET_TOTAL :</strong>
						Variable personnalis√©e pour notre app</li>
				</ul>
				<p>
					<strong>Acc√®s dans le code :</strong>
					$_ENV['PRET_TOTAL'] ou via DotEnv</p>
			</div>

			<h4>7. On cr√©e le contr√¥leur en allant dans le docker (tu peux utiliser le terminal de vscode et faire
				<code>dbash tablo</code>)</h4>
			<pre><code>sc make:controller TestController</code></pre>
			<p>On voit que l'on a une erreur (background rouge) qui dit que la commande make n'existe pas et qu'il faut ajouter la d√©pendance composer par
				<code>composer require symfony/maker-bundle --dev</code>
			</p>
			<p>On relance la commande maintenant que la librairie est install√©e et on r√©ponds non √† la question pour cr√©er un fichier test (on a pas install√© les outils pour)</p>
			<pre><code>sc make:controller TestController</code></pre>
			<p>On peut maintenant voir le contr√¥leur dans
				<code>src/Controller/TestController.php</code>
			</p>
			<p>On peut aussi voir que le contr√¥leur a une route
				<code>#[Route('/test', name: 'app_test')]</code>
			</p>
			<p>On peut maintenant aller pour le voir sur
				<code>http://localhost:8080/test</code>
			</p>
			<blockquote>on peut aussi avoir de l'aide sur les commande en mettant --help par exemple
				<code>sc make:controller --help</code>
			</blockquote>

			<div class="explanation">
				<h5>üéõÔ∏è Premier contr√¥leur et gestion d'erreurs</h5>
				<p>
					<strong>Erreur "make command not found" :</strong>
				</p>
				<ul>
					<li>
						<strong>Probl√®me :</strong>
						MakerBundle non install√©</li>
					<li>
						<strong>Solution :</strong>
						composer require symfony/maker-bundle --dev</li>
					<li>
						<strong>--dev :</strong>
						D√©pendance de d√©veloppement uniquement</li>
				</ul>
				<p>
					<strong>Structure du contr√¥leur cr√©√© :</strong>
				</p>
				<ul>
					<li>
						<strong>Namespace :</strong>
						App\Controller (organisation du code)</li>
					<li>
						<strong>Use statements :</strong>
						Imports des classes n√©cessaires</li>
					<li>
						<strong>H√©ritage :</strong>
						extends AbstractController (m√©thodes h√©rit√©es)</li>
					<li>
						<strong>Route :</strong>
						#[Route('/test', name: 'app_test')]</li>
					<li>
						<strong>M√©thode :</strong>
						public function index(): JsonResponse</li>
				</ul>
				<p>
					<strong>Test :</strong>
					http://localhost:8080/test affiche la r√©ponse JSON</p>
			</div>

			<h4>Questions</h4>
			<ol>
				<li>
					<strong>Composer installe des librairies JavaScript :</strong>
					Oui / Non ?</li>
				<li>
					<strong>Pour ajouter une d√©pendance avec Composer, on utilise :</strong>
					<code>composer ______</code>
				</li>
				<li>
					<strong>Pour ajouter une d√©pendance de d√©veloppement uniquement :</strong>
					<code>composer require symfony/maker-bundle ______</code>
				</li>
				<li>
					<strong>Configuration d'environnement :</strong>
					Si on a dans
					<code>.env</code>
					TOTO=1 et dans
					<code>.env.local</code>
					TOTO=2, notre application aura quelle valeur pour TOTO ?</li>
				<li>
					<strong>Comment cr√©er un contr√¥leur ?</strong>
					<code>sc ______</code>
				</li>
				<li>
					<strong>Question pour les pros :</strong>
					Comment cr√©er une entit√© ?
					<code>sc ______</code>
				</li>
				<li>
					<strong>Pour voir toutes les routes de l'application :</strong>
					<code>sc ______</code>
				</li>
				<li>
					<strong>Exercice pratique :</strong>
					Essayez de cr√©er une route √† la main dans le contr√¥leur qui affiche une r√©ponse HTML "Hello World" (sans utiliser de template Twig, juste du HTML direct)</li>
			</ol>

			<div class="explanation">
				<h5>üéì Concepts cl√©s et bonnes pratiques</h5>
				<p>
					<strong>Composer (gestionnaire de d√©pendances PHP) :</strong>
				</p>
				<ul>
					<li>
						<strong>composer.json :</strong>
						D√©finit les d√©pendances du projet</li>
					<li>
						<strong>vendor/ :</strong>
						Dossier des librairies install√©es</li>
					<li>
						<strong>--dev :</strong>
						Outils de d√©veloppement (tests, debug, maker)</li>
					<li>
						<strong>Autoload :</strong>
						Chargement automatique des classes</li>
				</ul>
				<p>
					<strong>Messages d'erreur Symfony :</strong>
				</p>
				<ul>
					<li>
						<strong>Explicites :</strong>
						Indiquent souvent la solution</li>
					<li>
						<strong>Background rouge :</strong>
						Erreurs critiques dans le terminal</li>
					<li>
						<strong>Suggestions :</strong>
						Commandes √† ex√©cuter pour corriger</li>
				</ul>
				<p>
					<strong>Aide contextuelle :</strong>
					--help sur toutes les commandes pour plus d'infos</p>
			</div>

		</div>

		<div id="part1" class="part">
			<h2>üöÄ Partie 1: Authentification et s√©curit√©</h2>

			<h3>üîê Configuration de l'authentification</h3>

			<h4>1. Installer Twig</h4>
			<pre><code>composer require twig</code></pre>
			<p class="info">Twig est le moteur de templates de Symfony pour cr√©er des pages HTML, il va nous permettre de cr√©er des pages html qu'on a besoin pour un beau login, les pages du site...</p>

			<div class="explanation">
				<h5>üîë Moteur de templates Twig</h5>
				<p>Twig est le moteur de templates par d√©faut de Symfony :</p>
				<ul>
					<li>Syntaxe simple et s√©curis√©e</li>
					<li>H√©ritage de templates</li>
					<li>√âchappement automatique des donn√©es</li>
					<li>Fonctions et filtres int√©gr√©s</li>
				</ul>
			</div>

			<h4>2. Installer Doctrine ORM</h4>
			<pre><code class="language-bash">composer require symfony/orm-pack</code></pre>
			<p class="info">ORM-Pack installe Doctrine ORM et tous les composants n√©cessaires pour la base de donn√©es</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Installation de Doctrine ORM</h5>
				<p>L'ORM-Pack installe plusieurs composants essentiels :</p>
				<ul>
					<li>
						<strong>Doctrine ORM :</strong>
						Mapping objet-relationnel pour PHP</li>
					<li>
						<strong>Doctrine Bundle :</strong>
						Int√©gration Symfony</li>
					<li>
						<strong>Doctrine Migrations :</strong>
						Versioning de la base de donn√©es</li>
					<li>
						<strong>Doctrine Fixtures :</strong>
						Donn√©es de test</li>
				</ul>
				<p>
					<strong>Avantage :</strong>
					Une seule commande installe tout l'√©cosyst√®me base de donn√©es</p>
			</div>

			<h4>3. Configurer SQLite dans .env</h4>
			<p>Modifier le fichier
				<code>.env</code>
				pour changer la configuration de base de donn√©es :</p>
			<p># Commenter PostgreSQL (ligne par d√©faut)</p>
			<pre><code class="language-bash"># DATABASE_URL="postgresql://app:!ChangeMe!@127.0.0.1:5432/app?serverVersion=16&charset=utf8"
</code></pre>
			<p># Activer SQLite (d√©commenter ou ajouter)</p>
			<pre><code class="language-bash">DATABASE_URL="sqlite:///%kernel.project_dir%/var/data.db"</code></pre>
			<div class="explanation">
				<h5>üóÑÔ∏è Configuration SQLite vs PostgreSQL</h5>
				<p>Pourquoi choisir SQLite pour le d√©veloppement :</p>
				<ul>
					<li>
						<strong>Simplicit√© :</strong>
						Pas de serveur √† installer</li>
					<li>
						<strong>Fichier unique :</strong>
						Base stock√©e dans var/data.db</li>
					<li>
						<strong>Portable :</strong>
						Fonctionne sur tous les syst√®mes</li>
					<li>
						<strong>Rapide :</strong>
						Id√©al pour le d√©veloppement et les tests</li>
				</ul>
				<p>
					<strong>URL format :</strong>
					sqlite:///chemin/vers/fichier.db</p>
				<p>
					<strong>%kernel.project_dir% :</strong>
					Variable Symfony = racine du projet</p>
			</div>

			<h4>4. Cr√©er la base de donn√©es</h4>
			<pre><code class="language-bash">sc doctrine:database:create</code></pre>
			<p class="info">ou plus court :
				<code>sc d:d:c</code>
			</p>
			<p>Cette commande cr√©e le fichier SQLite
				<code>var/data.db</code>
				s'il n'existe pas</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Cr√©ation de la base SQLite</h5>
				<p>La commande doctrine:database:create :</p>
				<ul>
					<li>
						<strong>Lit DATABASE_URL :</strong>
						Depuis .env ou .env.local</li>
					<li>
						<strong>Cr√©e le fichier :</strong>
						var/data.db pour SQLite</li>
					<li>
						<strong>Permissions :</strong>
						Fichier accessible en lecture/√©criture</li>
					<li>
						<strong>V√©rification :</strong>
						Erreur si la base existe d√©j√†</li>
				</ul>
				<p>
					<strong>Raccourci :</strong>
					sc d:d:c pour aller plus vite</p>
			</div>

			<h4>5. V√©rifier la configuration</h4>
			<pre><code class="language-bash">sc doctrine:schema:create</code></pre>
			<p class="info">ou plus court :
				<code>sc d:s:c</code>
			</p>
			<p>Cette commande confirme que la connexion √† la base fonctionne (m√™me si aucune table n'est cr√©√©e pour l'instant)</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Test de la configuration</h5>
				<p>doctrine:schema:create v√©rifie :</p>
				<ul>
					<li>
						<strong>Connexion :</strong>
						DATABASE_URL valide</li>
					<li>
						<strong>Permissions :</strong>
						√âcriture possible sur le fichier</li>
					<li>
						<strong>Configuration :</strong>
						Doctrine bien configur√©</li>
					<li>
						<strong>Sch√©ma :</strong>
						Pr√™t √† recevoir des entit√©s</li>
				</ul>
				<p>
					<strong>Message attendu :</strong>
					"Database schema created successfully!" ou "Nothing to update"</p>
			</div>

			<h4>6. Cr√©er l'entit√© User</h4>
			<pre><code class="language-bash">sc make:user</code></pre>
			<p class="warning">Erreur ;-), A toi de la r√©parer
			</p>
			<p class="info">R√©ponds aux questions : User comme nom, yes pour database, email comme propri√©t√© unique, yes pour encoder password</p>
			<div class="explanation">
				<h5>üîë Cr√©ation de l'entit√© User</h5>
				<p>La commande make:user en d√©tail :</p>
				<ul>
					<li>
						<strong>Entit√© User :</strong>
						Repr√©sente un utilisateur</li>
					<li>
						<strong>Propri√©t√©s :</strong>
						Email, Password, Roles</li>
					<li>
						<strong>Repository :</strong>
						Gestion des requ√™tes sur la table user</li>
					<li>
						<strong>Configuration :</strong>
						Dans security.yaml pour l'authentification</li>
				</ul>
				<p></p>
			</div>

			<div class="explanation">
				<h5>üîë Fichiers cr√©√©s par make:user</h5>
				<p>La commande g√©n√®re automatiquement :</p>
				<ul>
					<li>
						<code>src/Entity/User.php</code>
						- Entit√© utilisateur avec email/password</li>
					<li>
						<code>src/Repository/UserRepository.php</code>
						- Repository pour g√©rer les requ√™tes</li>
					<li>Configuration dans
						<code>security.yaml</code>
					</li>
				</ul>
			</div>

			<h4>3. Cr√©er le syst√®me d'authentification</h4>
			<pre><code class="language-bash">sc make:security:form-login</code></pre>
			<p class="info">Choisis "SecurityController" comme nom du contr√¥leur, oui pour logout afin qu'il te cr√©e un logout pour permettre aux users de se d√©connecter et non pour g√©n√©rer un test phpunit</p>

			<div class="explanation">
				<h5>üîë Fichiers cr√©√©s par make:security:form-login</h5>
				<p>Cette commande g√©n√®re :</p>
				<ul>
					<li>
						<code>src/Controller/SecurityController.php</code>
						- Login/logout</li>
					<li>
						<code>src/Security/AppAuthenticator.php</code>
						- Logique d'authentification</li>
					<li>
						<code>templates/security/login.html.twig</code>
						- Formulaire de connexion</li>
				</ul>
			</div>

			<h4>4. Cr√©er et appliquer la migration</h4>
			<pre><code class="language-bash">sc doctrine:shema:update -f</code></pre>
			<p class="info">ou plus court :
				<code>sc d:s:u -f</code>
			</p>
			<p>Cette commande cr√©e les tables dans la base de donn√©es selon les entit√©s d√©finies</p>
			<p>On peut aussi faire
				<code>sc make:migration</code>
				pour g√©n√©rer un fichier de migration, puis
				<code>sc doctrine:migrations:migrate</code>
				pour appliquer les migrations</p>
			<div class="explanation">
				<h5>üîë Migration et base de donn√©es</h5>
				<p>La commande doctrine:schema:update -f :</p>
				<ul>
					<li>Met √† jour la base de donn√©es selon les entit√©s</li>
					<li>Cr√©e les tables manquantes</li>
					<li>Applique les changements de sch√©ma</li>
				</ul>
			</div>

			<h4>5. Cr√©er une fixture pour les utilisateurs</h4>
			<pre><code class="language-bash">sc make:fixtures UserFixtures</code></pre>
			<p class="info">Corrige l'erreur</p>
			<p>La commande g√©n√®re un fichier vide dans
				<code>src/DataFixtures/UserFixtures.php</code>
			</p>

			<h5>On va y ajouter du code pour cr√©er des utilisateurs de test</h5>
			<p>On va modifier la m√©thode load() pour cr√©er les utilisateurs</p>
			<p class="warning">La m√©thode load appartient √† notre class qui est un enfant de extends Fixture donc notre class √† acc√®s √† toutes les m√©thodes de Fixture et nottament √† load qui nous oblige du coup √† respecter comment la m√©thode est d√©finie.</p>
			<pre><code class="language-php">public function load(ObjectManager $manager): void
{
	$user = new User();
	$user->setEmail('a@aa.aa');
	$hashedPassword = $this->passwordHasher->hashPassword(
		$user,
		'motdepasse'
	);
	$user->setPassword($hashedPassword);
	$manager->persist($user);

	$manager->flush();
}</code></pre>
			<p>On va utiliser le service UserPasswordHasherInterface pour hasher les mots de passe, pour √ßa on doit le d√©clarer dans contruct pour s'en servir. Construct est appel√© √† chaque appel de cette classe. Tout ce que l'on d√©clare dedans peut donc √™tre appel√© par $this->
			</p>
			<p>On va aussi ajouter la propri√©t√© private UserPasswordHasherInterface $passwordHasher; pour pouvoir l'utiliser dans notre m√©thode load, on met le code du construct juste sous
				<code>Class UserFixtures ... {</code>
			</p>
			<pre><code class="language-php">private UserPasswordHasherInterface $passwordHasher;
public function __construct(UserPasswordHasherInterface $passwordHasher)
{
	$this->passwordHasher = $passwordHasher;
}</code></pre>
			<p class="warning">Si on lance
				<code>
					sc d:f:l -n</code>
				qui doit lancer les fixtures et donc nous cr√©er un utilisateur dans la bd on a une erreur
				<code class="language-bash">
					Cannot autowire service "App\DataFixtures\UserFixtures": argument "$passwordHasher" of method "__construct()" has type "App\DataFixtures\UserPasswordHasherInterface" but this class was not found.</code>
			</p>
			<p class="info">C'est une erreur fr√©quente quand on tape du code. Pour corriger l'erreur, on doit ajouter le use pour UserPasswordHasherInterface en haut du fichier pour cela on va sur UserPasswordHasherInterface, clic droit ‚Üí "Import Class", cela nous  ajoute automatiquement en haut de la class
				<code>use Symfony\Component\PasswordHasher\UserPasswordHasherInterface;</code>
			</p>
			<p class="info">Il faut penser √† sauvegarder par CTRL+S</p>
			<p>On peut maintenant lancer la commande
				<pre><code>sc d:f:l -n</code></pre>
				pour charger les fixtures et cr√©er l'utilisateur dans la base de donn√©es</p>
			<p class="info">Il est importnat de reconnaitre les erreurs par exemple dans notre cas ona SQLSTATE et ensuite on a une erreur mais Symfony nous guide par Did you forget ... Tu as pas oubli√© .., prendre le temps de lire ;-). Les deux ereerus qui suivent sont tr√®s fr√©quentes et facile √† rep√©rer.</p>
			<p class="warning">Si on a une erreru du genre de
				<code class="language-bash">
					An exception occurred while executing a query: SQLSTATE[HY000]: General error: 1 no such table: user
				</code>
				on doit v√©rifier que l'on a bien cr√©√© la table user dans la base de donn√©es, pour cela on peut faire
				<code>sc d:s:u -f</code>
			</p>
			<pre><code>sc d:f:l -n</code></pre>
			<p class="warning">On a encore une erreur
				<code class="language-bash">
					Attempted to load class "User" from namespace "App\DataFixtures".Did you forget a "use" statement for "App\Entity\User"?
				</code>
				et pour corriger l'erreur, on doit ajouter le use pour User et on sauvegarde, cela va nous ajouter
				<code>use App\Entity\User;</code>
			</p>
			<pre><code>sc d:f:l -n</code></pre>
			<p class="success">On a maintenant un utilisateur cr√©√© dans la base de donn√©es.</p>

			<div class="explanation">
				<h5>üîë Cr√©ation de la fixture UserFixtures</h5>
				<p>La commande
					<code>sc make:fixtures UserFixtures</code>
					g√©n√®re un fichier de base :</p>
				<ul>
					<li>
						<strong>Namespace :</strong>
						App\DataFixtures</li>
					<li>
						<strong>Classe :</strong>
						H√©rite de Fixture</li>
					<li>
						<strong>M√©thode load() :</strong>
						√Ä compl√©ter avec nos donn√©es</li>
				</ul>
				<p>
					<strong>But :</strong>
					Cr√©er des donn√©es de test automatiquement</p>
				<p>
					<strong>m√©thode persist()</strong>
					de l'ObjectManager: pour enregistrer les utilisateurs</p>
				<p>
					<strong>m√©thode flush()</strong>
					de l'ObjectManager: pour appliquer les changements</p>

				<p>On a souvent des boucles avec des persist dedans et apr√®s la boucle 1 flush, √ßa permet d'optimiser les performances.</p>
			</div>


			<h4>8. Configurer l'acc√®s aux routes</h4>
			<p>Dans
				<code>config/packages/security.yaml</code>, modifier la section access_control :</p>
			<pre><code class="language-yaml">access_control:
    - { path: ^/login, roles: PUBLIC_ACCESS }
    - { path: ^/home, roles: ROLE_USER }</code></pre>

			<p>
				<strong>Explication :</strong>
			</p>
			<ul>
				<li>
					<code>^/login</code>
					‚Üí accessible sans connexion, indispensable</li>
				<li>
					<code>^/home</code>
					‚Üí pour les utilisateurs connect√©s</li>
				<li>L'ordre est important (plus sp√©cifique en premier)</li>

			</ul>

			<div class="explanation">
				<h5>üîë Configuration des r√®gles d'acc√®s</h5>
				<p>
					<strong>access_control dans security.yaml :</strong>
				</p>
				<ul>
					<li>
						<code>^/login</code>
						‚Üí PUBLIC_ACCESS (accessible sans login)</li>
					<li>
						<code>^/</code>
						‚Üí ROLE_USER (toutes les autres routes prot√©g√©es)</li>

				</ul>
				<p>
					<strong>Effet :</strong>
					Redirection automatique vers /login si non connect√©</p>
			</div>
			<h4>9. Cr√©ation d'un HomeController avec une vue twig</h4>
			<pre><code>sc make:controller HomeController</code></pre>
			<p class="info">On r√©pond non √† la question pour cr√©er un fichier test (on a pas install√© les outils pour). Et comparer √† toute √† l'heure on va avoir des fichiers twigs qui vont √™tre cr√©√©s :</p>
			<ul>
				<li>
					<code>src/Controller/HomeController.php</code>
					- Contr√¥leur pour la page d'accueil</li>
				<li>
					<code>templates/home/index.html.twig</code>
					- Template Twig pour la vue</li>
				<li>
					<code>templates/base.html.twig</code>
					- Template de base Twig</li>
			</ul>
			<h4>10. Vider le cache et tester</h4>
			<pre><code class="language-bash">sc cache:clear</code></pre>
			<p>Cette commande vide le cache Symfony pour que les modifications de s√©curit√© soient prises en compte.</p>
			<p>
				<strong>Test de l'authentification :</strong>
			</p>
			<p>Acc√©der √†
				<code>http://localhost:8080/home</code>
			</p>
			<p class="info">‚úÖ Vous devriez √™tre redirig√© vers /login</p>
			<p>
				<strong>V√©rifications :</strong>
			</p>
			<ul>
				<li>URL change automatiquement pour /login</li>
				<li>Formulaire de connexion affich√©</li>
				<li>Champs email et password pr√©sents</li>
			</ul>
			<h4>10. Se connecter</h4>
			<p>
				<strong>Identifiants cr√©√©s par la fixture :</strong>
			</p>
			<ul>
				<li>
					<strong>Email :</strong>
					a@aa.aa</li>
				<li>
					<strong>Password :</strong>
					motdepasse</li>
			</ul>
			<p class="success">‚úÖ Authentification r√©ussie !</p>
			<p>Vous √™tes maintenant connect√© et pouvez acc√©der aux pages prot√©g√©es.</p>

			<h4>12. Installer la debugbar</h4>
			<pre><code>composer require --dev symfony/profiler-pack</code></pre>
			<p class="info">La debugbar permet de voir les requ√™tes, les routes, les entit√©s, les requ√™tes SQL...</p>
			<p>On peut la voir en bas de la page √† condition que tu ai pens√© √† vider le cache ;-)</p>
			<p class="info">Avant de continuer va jeter un coup d'oeil au HomeController et au deux fichiers de template. C'est important</p>
			<div class="explanation">
				<h5>üîß Debugbar Symfony</h5>
				<p>La debugbar affiche :</p>
				<ul>
					<li>
						<strong>Requ√™tes SQL :</strong>
						Toutes les requ√™tes ex√©cut√©es</li>
					<li>
						<strong>Routes :</strong>
						Routes utilis√©es dans la requ√™te</li>
					<li>
						<strong>Entit√©s :</strong>
						Donn√©es charg√©es depuis la base</li>
					<li>
						<strong>Performances :</strong>
						Temps d'ex√©cution</li>
					<li>
						<strong>Utilisateurs :</strong>
						Informations sur les utilisateurs connect√©s et possibilit√© de se d√©connecter</li>
				</ul>
				<br>
				<h5>le fichier Controller avec twig</h5>
				<p>Le fichier
					<code>src/Controller/HomeController.php</code>
					contient la logique pour afficher la page d'accueil :</p>
				<ul>
					<li>La m√©thode
						<code>index()</code>
						retourne le template
						<code>home/index.html.twig</code>
					</li>
					<li>Response: permet de renvoyer une r√©ponse HTTP avec le contenu du template, on peux renvoyer des fichiers, des jsons, des images ...</li>
					<li>Les param√®tres du twig: permettent de passer des variables au template,  dans
						<code>
							return $this->render('home/index.html.twig', ['controller_name' => 'HomeController',]);</code>,on renvoie la variable
						<code>controller_name</code>, et on peut acc√©der √† ces variables dans le template avec
						<code>{{ controller_name }}</code>.</li>
				</ul>
			</div>
			<h4>13. D√©connexion</h4>
			<p>il suffit d'aller sur
				<code>http://localhost:8080/logout</code>
				pour se d√©connecter, on est redirig√© vers la page de login.</p>
			<p class="info">On voit dans la debugbar que l'on est d√©connect√©.</p>
		</div>


	</body>
</html>
