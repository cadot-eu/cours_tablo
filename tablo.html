<!DOCTYPE html>
<html lang="fr">

	<head>
		<meta charset="UTF-8">
		<title>Guide Symfony Pr√™t Travaux - Tablo</title>
		<link rel="stylesheet" href="styles.css">
		<!-- CSS du th√®me (choisissez-en un) -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

		<!-- Scripts Highlight.js -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/twig.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/php.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/css.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/xml.min.js"></script>
		<!-- Initialisation -->
		<script>
			document.addEventListener('DOMContentLoaded', () => {
				document.querySelectorAll('script[type="text/plain"]').forEach(el => {
					const pre = document.createElement('pre')
					const code = document.createElement('code')
					code.className = el.className
					code.textContent = el.textContent.trim()
					pre.appendChild(code)
					el.parentNode.replaceChild(pre, el)
				})
				hljs.highlightAll()
			})
		</script>



	</head>

	<body>
		<h1>üèóÔ∏è Guide de Construction d'une Application de Gestion de Pr√™t Travaux avec Symfony 7.3</h1>
		<div class="danger">Attention : Si tu veux vraiment retenir le code tape le! pas de copier-coller!!! J'ai pris le temps de metre le minimum de code √† taper</div>
		<div id="sommaire">
			<h2>üìö Sommaire</h2>
			<ol>
				<li><a href="#intro">Introduction & Utilisation rapide sans installation</a></li>
				<li><a href="#part0">Partie 0 - Pr√©paration de l'environnement Docker</a></li>
				<li><a href="#part1">Partie 1 - Configuration initiale et authentification</a></li>
				<li><a href="#part2">Partie 2 - Impl√©mentation du tableau interactif</a></li>
				<li><a href="#part3">Partie 3 - Am√©liorations et tests</a></li>
				<li><a href="#bonus">Bonus - Aller plus loin avec Symfony</a></li>
			</ol>
		</div>

		<div id="intro" class="part">
			<h2>üöÄ Introduction & Utilisation rapide sans installation</h2>
			<p>
				Ce tutoriel est con√ßu pour les d√©butants.<br>
				<strong>Pour tester l'application sans rien installer, il suffit d'ouvrir ce fichier <code>tablo.html</code> dans votre navigateur !</strong>
			</p>
			<p>
				Vous pourrez ensuite explorer la version Symfony pour aller plus loin (authentification, base de donn√©es, etc).
			</p>
		</div>

		<div id="part0" class="part">
			<h2>üê≥ Partie 0: Cr√©ation de l'application Symfony</h2>
			<p>Installation des outils de debs par
				<code>cd ~ && git clone https://github.com/cadot-eu/debs.git && ./installdebs</code>
			</p>

			<h3>üöÄ Commandes essentielles</h3>

			<h4>1. Le docker cr√©era un symfony automatiquement</h4>
			<pre><code>dc up -d && dlogs tablo</code></pre>
			<p>il faut attendre d'avoir Command line: 'apache2 -E /dev/stderr -D FOREGROUND' pour que symfony soit install√© et le docker pr√™t, cela peut prendre 2-3 mn quand tu le vois CTRL+C pour quitter dlogs</p>

			<div class="explanation">
				<h5>üê≥ D√©marrage automatique du conteneur Docker</h5>
				<p>Le docker utilise une image avec Symfony pr√©-install√© :</p>
				<ul>
					<li>
						<strong>dc up -d :</strong>
						D√©marre le conteneur en arri√®re-plan
					</li>
					<li>
						<strong>dlogs tablo :</strong>
						Affiche les logs en temps r√©el
					</li>
					<li>
						<strong>Installation compl√®te :</strong>
						Tous les bundles essentiels (Twig, Doctrine, Security)
					</li>
					<li>
						<strong>Structure pr√™te :</strong>
						bin/console automatiquement cr√©√©
					</li>
				</ul>
				<p>
					<strong>Attendre le message Apache :</strong>
					Indique que Symfony est enti√®rement op√©rationnel
				</p>
			</div>

			<h4>2. On voit notre docker</h4>
			<pre><code>docker ps</code></pre>

			<div class="explanation">
				<h5>üîç Inspection des conteneurs actifs</h5>
				<p>La commande
					<code>docker ps</code>
					affiche :
				</p>
				<ul>
					<li>
						<strong>CONTAINER ID :</strong>
						Pour tuer le docker (docker kill num√©ro) ou avoir des infos (docker inspect num√©ro)
					</li>
					<li>
						<strong>Image :</strong>
						cadoteu/symfony5-6-runsite (docker avec tout dedans pour faire tourner Symfony)
					</li>
					<li>
						<strong>STATUS :</strong>
						Pour voir si le docker tourne (Up)
					</li>
					<li>
						<strong>PORTS :</strong>
						0.0.0.0:8080->80 et 0.0.0.0:4443->443
					</li>
					<li>
						<strong>NAME :</strong>
						tablo (nom du conteneur)
					</li>
				</ul>
				<p>
					<strong>Acc√®s web :</strong>
					http://localhost:8080 ou https://localhost:4443
				</p>
			</div>

			<h4>3. Acc√®s conteneur</h4>
			<pre><code>dbash tablo</code></pre>

			<div class="explanation">
				<h5>üñ•Ô∏è Shell interactif dans le conteneur</h5>
				<p>dbash permet d'entrer dans le conteneur :</p>
				<ul>
					<li>
						<strong>Shell bash :</strong>
						Ligne de commande compl√®te
					</li>
					<li>
						<strong>Environnement Symfony :</strong>
						Tous les outils disponibles
					</li>
					<li>
						<strong>sc :</strong>
						Raccourci pour php bin/console
					</li>
					<li>
						<strong>Composer :</strong>
						Gestionnaire de d√©pendances PHP
					</li>
				</ul>
			</div>

			<h4>4. V√©rification de l'installation</h4>
			<pre><code>sc list</code></pre>

			<div class="explanation">
				<h5>üìù Commandes Symfony disponibles</h5>
				<p>sc est le raccourci de php bin/console :</p>
				<ul>
					<li>
						<strong>sc list :</strong>
						Liste des commandes disponibles
					</li>
					<li>
						<strong>sc make:controller :</strong>
						Cr√©e un contr√¥leur
					</li>
					<li>
						<strong>sc make:entity :</strong>
						Cr√©e une entit√© Doctrine
					</li>
					<li>
						<strong>sc doctrine:schema:update -f :</strong>
						Met √† jour la base
					</li>
					<li>
						<strong>sc doctrine:fixtures:load :</strong>
						Charge les fixtures
					</li>
					<li>
						<strong>sc cache:clear :</strong>
						Vide le cache
					</li>
					<li>
						<strong>sc debug:router :</strong>
						Affiche les routes
					</li>
				</ul>
			</div>

			<h4>5. Sortir du conteneur</h4>
			<pre><code>exit</code></pre>

			<div class="explanation">
				<h5>üö™ Retour √† l'environnement local</h5>
				<p>La commande
					<code>exit</code>
					ferme la session dans le conteneur et retourne √† votre terminal local.
				</p>
			</div>

			<h4>6. Configuration .env</h4>
			<p>on ouvre vscode sur notre projet
			<pre><code>cd project-tablo && code .</code></pre>
			</p>
			<p>On ajoute dans .env.local (il faut le cr√©er)</p>
			<pre><code>APP_ENV=dev
			PRET_TOTAL=34000</code></pre>

			<div class="explanation">
				<h5>‚öôÔ∏è Configuration d'environnement</h5>
				<p>Fichiers d'environnement Symfony :</p>
				<ul>
					<li>
						<strong>.env :</strong>
						Variables par d√©faut (versionn√©es)
					</li>
					<li>
						<strong>.env.local :</strong>
						Variables locales (non versionn√©es)
					</li>
					<li>
						<strong>Priorit√© :</strong>
						.env.local remplace .env
					</li>
					<li>
						<strong>APP_ENV=dev :</strong>
						Mode d√©veloppement
					</li>
					<li>
						<strong>PRET_TOTAL :</strong>
						Variable personnalis√©e pour notre app
					</li>
				</ul>
				<p>
					<strong>Acc√®s dans le code :</strong>
					$_ENV['PRET_TOTAL'] ou via DotEnv
				</p>
			</div>

			<h4>7. On cr√©e le contr√¥leur en allant dans le docker (tu peux utiliser le terminal de vscode et faire
				<code>dbash tablo</code>)
			</h4>
			<pre><code>sc make:controller TestController</code></pre>
			<p>On voit que l'on a une erreur (background rouge) qui dit que la commande make n'existe pas et qu'il faut ajouter la d√©pendance composer par
				<code>composer require symfony/maker-bundle --dev</code>
			</p>
			<p>On relance la commande maintenant que la librairie est install√©e et on r√©ponds non √† la question pour cr√©er un fichier test (on a pas install√© les outils pour)</p>
			<pre><code>sc make:controller TestController</code></pre>
			<p>On peut maintenant voir le contr√¥leur dans
				<code>src/Controller/TestController.php</code>
			</p>
			<p>On peut aussi voir que le contr√¥leur a une route
				<code>#[Route('/test', name: 'app_test')]</code>
			</p>
			<p>On peut maintenant aller pour le voir sur
				<code>http://localhost:8080/test</code>
			</p>
			<blockquote>on peut aussi avoir de l'aide sur les commande en mettant --help par exemple
				<code>sc make:controller --help</code>
			</blockquote>

			<div class="explanation">
				<h5>üéõÔ∏è Premier contr√¥leur et gestion d'erreurs</h5>
				<p>
					<strong>Erreur "make command not found" :</strong>
				</p>
				<ul>
					<li>
						<strong>Probl√®me :</strong>
						MakerBundle non install√©
					</li>
					<li>
						<strong>Solution :</strong>
						composer require symfony/maker-bundle --dev
					</li>
					<li>
						<strong>--dev :</strong>
						D√©pendance de d√©veloppement uniquement
					</li>
				</ul>
				<p>
					<strong>Structure du contr√¥leur cr√©√© :</strong>
				</p>
				<ul>
					<li>
						<strong>Namespace :</strong>
						App\Controller (organisation du code)
					</li>
					<li>
						<strong>Use statements :</strong>
						Imports des classes n√©cessaires
					</li>
					<li>
						<strong>H√©ritage :</strong>
						extends AbstractController (m√©thodes h√©rit√©es)
					</li>
					<li>
						<strong>Route :</strong>
						#[Route('/test', name: 'app_test')]
					</li>
					<li>
						<strong>M√©thode :</strong>
						public function index(): JsonResponse
					</li>
				</ul>
				<p>
					<strong>Test :</strong>
					http://localhost:8080/test affiche la r√©ponse JSON
				</p>
			</div>

			<h4>Questions</h4>
			<ol>
				<li>
					<strong>Composer installe des librairies JavaScript :</strong>
					Oui / Non ?
				</li>
				<li>
					<strong>Pour ajouter une d√©pendance avec Composer, on utilise :</strong>
					<code>composer ______</code>
				</li>
				<li>
					<strong>Pour ajouter une d√©pendance de d√©veloppement uniquement :</strong>
					<code>composer require symfony/maker-bundle ______</code>
				</li>
				<li>
					<strong>Configuration d'environnement :</strong>
					Si on a dans
					<code>.env</code>
					TOTO=1 et dans
					<code>.env.local</code>
					TOTO=2, notre application aura quelle valeur pour TOTO ?
				</li>
				<li>
					<strong>Comment cr√©er un contr√¥leur ?</strong>
					<code>sc ______</code>
				</li>
				<li>
					<strong>Question pour les pros :</strong>
					Comment cr√©er une entit√© ?
					<code>sc ______</code>
				</li>
				<li>
					<strong>Pour voir toutes les routes de l'application :</strong>
					<code>sc ______</code>
				</li>
				<li>
					<strong>Exercice pratique :</strong>
					Essayez de cr√©er une route √† la main dans le contr√¥leur qui affiche une r√©ponse HTML "Hello World" (sans utiliser de template Twig, juste du HTML direct)
				</li>
			</ol>

			<div class="explanation">
				<h5>üéì Concepts cl√©s et bonnes pratiques</h5>
				<p>
					<strong>Composer (gestionnaire de d√©pendances PHP) :</strong>
				</p>
				<ul>
					<li>
						<strong>composer.json :</strong>
						D√©finit les d√©pendances du projet
					</li>
					<li>
						<strong>vendor/ :</strong>
						Dossier des librairies install√©es
					</li>
					<li>
						<strong>--dev :</strong>
						Outils de d√©veloppement (tests, debug, maker)
					</li>
					<li>
						<strong>Autoload :</strong>
						Chargement automatique des classes
					</li>
				</ul>
				<p>
					<strong>Messages d'erreur Symfony :</strong>
				</p>
				<ul>
					<li>
						<strong>Explicites :</strong>
						Indiquent souvent la solution
					</li>
					<li>
						<strong>Background rouge :</strong>
						Erreurs critiques dans le terminal
					</li>
					<li>
						<strong>Suggestions :</strong>
						Commandes √† ex√©cuter pour corriger
					</li>
				</ul>
				<p>
					<strong>Aide contextuelle :</strong>
					--help sur toutes les commandes pour plus d'infos
				</p>
			</div>

		</div>

		<div id="part1" class="part">
			<h2>üöÄ Partie 1: Authentification et s√©curit√©</h2>

			<h3>üîê Configuration de l'authentification</h3>

			<h4>1. Installer Twig</h4>
			<pre><code>composer require twig</code></pre>
			<p class="info">Twig est le moteur de templates de Symfony pour cr√©er des pages HTML, il va nous permettre de cr√©er des pages html qu'on a besoin pour un beau login, les pages du site...</p>

			<div class="explanation">
				<h5>üîë Moteur de templates Twig</h5>
				<p>Twig est le moteur de templates par d√©faut de Symfony :</p>
				<ul>
					<li>Syntaxe simple et s√©curis√©e</li>
					<li>H√©ritage de templates</li>
					<li>√âchappement automatique des donn√©es</li>
					<li>Fonctions et filtres int√©gr√©s</li>
				</ul>
			</div>

			<h4>2. Installer Doctrine ORM</h4>
			<pre><code class="language-bash">composer require symfony/orm-pack</code></pre>
			<p class="info">ORM-Pack installe Doctrine ORM et tous les composants n√©cessaires pour la base de donn√©es</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Installation de Doctrine ORM</h5>
				<p>L'ORM-Pack installe plusieurs composants essentiels :</p>
				<ul>
					<li>
						<strong>Doctrine ORM :</strong>
						Mapping objet-relationnel pour PHP
					</li>
					<li>
						<strong>Doctrine Bundle :</strong>
						Int√©gration Symfony
					</li>
					<li>
						<strong>Doctrine Migrations :</strong>
						Versioning de la base de donn√©es
					</li>
					<li>
						<strong>Doctrine Fixtures :</strong>
						Donn√©es de test
					</li>
				</ul>
				<p>
					<strong>Avantage :</strong>
					Une seule commande installe tout l'√©cosyst√®me base de donn√©es
				</p>
			</div>

			<h4>3. Configurer SQLite dans .env</h4>
			<p>Modifier le fichier
				<code>.env</code>
				pour changer la configuration de base de donn√©es :
			</p>
			<p># Commenter PostgreSQL (ligne par d√©faut)</p>
			<pre><code class="language-bash"># DATABASE_URL="postgresql://app:!ChangeMe!@127.0.0.1:5432/app?serverVersion=16&charset=utf8"
</code></pre>
			<p># Activer SQLite (d√©commenter ou ajouter)</p>
			<pre><code class="language-bash">DATABASE_URL="sqlite:///%kernel.project_dir%/var/data.db"</code></pre>
			<div class="explanation">
				<h5>üóÑÔ∏è Configuration SQLite vs PostgreSQL</h5>
				<p>Pourquoi choisir SQLite pour le d√©veloppement :</p>
				<ul>
					<li>
						<strong>Simplicit√© :</strong>
						Pas de serveur √† installer
					</li>
					<li>
						<strong>Fichier unique :</strong>
						Base stock√©e dans var/data.db
					</li>
					<li>
						<strong>Portable :</strong>
						Fonctionne sur tous les syst√®mes
					</li>
					<li>
						<strong>Rapide :</strong>
						Id√©al pour le d√©veloppement et les tests
					</li>
				</ul>
				<p>
					<strong>URL format :</strong>
					sqlite:///chemin/vers/fichier.db
				</p>
				<p>
					<strong>%kernel.project_dir% :</strong>
					Variable Symfony = racine du projet
				</p>
			</div>

			<h4>4. Cr√©er la base de donn√©es</h4>
			<pre><code class="language-bash">sc doctrine:database:create</code></pre>
			<p class="info">ou plus court :
				<code>sc d:d:c</code>
			</p>
			<p>Cette commande cr√©e le fichier SQLite
				<code>var/data.db</code>
				s'il n'existe pas
			</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Cr√©ation de la base SQLite</h5>
				<p>La commande doctrine:database:create :</p>
				<ul>
					<li>
						<strong>Lit DATABASE_URL :</strong>
						Depuis .env ou .env.local
					</li>
					<li>
						<strong>Cr√©e le fichier :</strong>
						var/data.db pour SQLite
					</li>
					<li>
						<strong>Permissions :</strong>
						Fichier accessible en lecture/√©criture
					</li>
					<li>
						<strong>V√©rification :</strong>
						Erreur si la base existe d√©j√†
					</li>
				</ul>
				<p>
					<strong>Raccourci :</strong>
					sc d:d:c pour aller plus vite
				</p>
			</div>

			<h4>5. V√©rifier la configuration</h4>
			<pre><code class="language-bash">sc doctrine:schema:create</code></pre>
			<p class="info">ou plus court :
				<code>sc d:s:c</code>
			</p>
			<p>Cette commande confirme que la connexion √† la base fonctionne (m√™me si aucune table n'est cr√©√©e pour l'instant)</p>

			<div class="explanation">
				<h5>üóÑÔ∏è Test de la configuration</h5>
				<p>doctrine:schema:create v√©rifie :</p>
				<ul>
					<li>
						<strong>Connexion :</strong>
						DATABASE_URL valide
					</li>
					<li>
						<strong>Permissions :</strong>
						√âcriture possible sur le fichier
					</li>
					<li>
						<strong>Configuration :</strong>
						Doctrine bien configur√©
					</li>
					<li>
						<strong>Sch√©ma :</strong>
						Pr√™t √† recevoir des entit√©s
					</li>
				</ul>
				<p>
					<strong>Message attendu :</strong>
					"Database schema created successfully!" ou "Nothing to update"
				</p>
			</div>

			<h4>6. Cr√©er l'entit√© User</h4>
			<pre><code class="language-bash">sc make:user</code></pre>
			<p class="warning">Erreur ;-), A toi de la r√©parer
			</p>
			<p class="info">R√©ponds aux questions : User comme nom, yes pour database, email comme propri√©t√© unique, yes pour encoder password</p>
			<div class="explanation">
				<h5>üîë Cr√©ation de l'entit√© User</h5>
				<p>La commande make:user en d√©tail :</p>
				<ul>
					<li>
						<strong>Entit√© User :</strong>
						Repr√©sente un utilisateur
					</li>
					<li>
						<strong>Propri√©t√©s :</strong>
						Email, Password, Roles
					</li>
					<li>
						<strong>Repository :</strong>
						Gestion des requ√™tes sur la table user
					</li>
					<li>
						<strong>Configuration :</strong>
						Dans security.yaml pour l'authentification
					</li>
				</ul>
				<p></p>
			</div>

			<div class="explanation">
				<h5>üîë Fichiers cr√©√©s par make:user</h5>
				<p>La commande g√©n√®re automatiquement :</p>
				<ul>
					<li>
						<code>src/Entity/User.php</code>
						- Entit√© utilisateur avec email/password
					</li>
					<li>
						<code>src/Repository/UserRepository.php</code>
						- Repository pour g√©rer les requ√™tes
					</li>
					<li>Configuration dans
						<code>security.yaml</code>
					</li>
				</ul>
			</div>

			<h4>3. Cr√©er le syst√®me d'authentification</h4>
			<pre><code class="language-bash">sc make:security:form-login</code></pre>
			<p class="info">Choisis "SecurityController" comme nom du contr√¥leur, oui pour logout afin qu'il te cr√©e un logout pour permettre aux users de se d√©connecter et non pour g√©n√©rer un test phpunit</p>

			<div class="explanation">
				<h5>üîë Fichiers cr√©√©s par make:security:form-login</h5>
				<p>Cette commande g√©n√®re :</p>
				<ul>
					<li>
						<code>src/Controller/SecurityController.php</code>
						- Login/logout
					</li>
					<li>
						<code>src/Security/AppAuthenticator.php</code>
						- Logique d'authentification
					</li>
					<li>
						<code>templates/security/login.html.twig</code>
						- Formulaire de connexion
					</li>
				</ul>
			</div>

			<h4>4. Cr√©er et appliquer la migration</h4>
			<pre><code class="language-bash">sc doctrine:shema:update -f</code></pre>
			<p class="info">ou plus court :
				<code>sc d:s:u -f</code>
			</p>
			<p>Cette commande cr√©e les tables dans la base de donn√©es selon les entit√©s d√©finies</p>
			<p>On peut aussi faire
				<code>sc make:migration</code>
				pour g√©n√©rer un fichier de migration, puis
				<code>sc doctrine:migrations:migrate</code>
				pour appliquer les migrations
			</p>
			<div class="explanation">
				<h5>üîë Migration et base de donn√©es</h5>
				<p>La commande doctrine:schema:update -f :</p>
				<ul>
					<li>Met √† jour la base de donn√©es selon les entit√©s</li>
					<li>Cr√©e les tables manquantes</li>
					<li>Applique les changements de sch√©ma</li>
				</ul>
			</div>

			<h4>5. Cr√©er une fixture pour les utilisateurs</h4>
			<pre><code class="language-bash">sc make:fixtures UserFixtures</code></pre>
			<p class="info">Corrige l'erreur</p>
			<p>La commande g√©n√®re un fichier vide dans
				<code>src/DataFixtures/UserFixtures.php</code>
			</p>

			<h5>On va y ajouter du code pour cr√©er des utilisateurs de test</h5>
			<p>On va modifier la m√©thode load() pour cr√©er les utilisateurs</p>
			<p class="warning">La m√©thode load appartient √† notre class qui est un enfant de extends Fixture donc notre class √† acc√®s √† toutes les m√©thodes de Fixture et nottament √† load qui nous oblige du coup √† respecter comment la m√©thode est d√©finie.</p>
			<pre><code class="language-php">public function load(ObjectManager $manager): void
{
	$user = new User();
	$user->setEmail('a@aa.aa');
	$hashedPassword = $this->passwordHasher->hashPassword(
		$user,
		'motdepasse'
	);
	$user->setPassword($hashedPassword);
	$manager->persist($user);

	$manager->flush();
}</code></pre>
			<p>On va utiliser le service UserPasswordHasherInterface pour hasher les mots de passe, pour √ßa on doit le d√©clarer dans contruct pour s'en servir. Construct est appel√© √† chaque appel de cette classe. Tout ce que l'on d√©clare dedans peut donc √™tre appel√© par $this->
			</p>
			<p>On va aussi ajouter la propri√©t√© private UserPasswordHasherInterface $passwordHasher; pour pouvoir l'utiliser dans notre m√©thode load, on met le code du construct juste sous
				<code>Class UserFixtures ... {</code>
			</p>
			<pre><code class="language-php">private UserPasswordHasherInterface $passwordHasher;
public function __construct(UserPasswordHasherInterface $passwordHasher)
{
	$this->passwordHasher = $passwordHasher;
}</code></pre>
			<p class="warning">Si on lance
				<code>
					sc d:f:l -n</code>
				qui doit lancer les fixtures et donc nous cr√©er un utilisateur dans la bd on a une erreur
				<code class="language-bash">
					Cannot autowire service "App\DataFixtures\UserFixtures": argument "$passwordHasher" of method "__construct()" has type "App\DataFixtures\UserPasswordHasherInterface" but this class was not found.</code>
			</p>
			<p class="info">C'est une erreur fr√©quente quand on tape du code. Pour corriger l'erreur, on doit ajouter le use pour UserPasswordHasherInterface en haut du fichier pour cela on va sur UserPasswordHasherInterface, clic droit ‚Üí "Import Class", cela nous ajoute automatiquement en haut de la class
				<code>use Symfony\Component\PasswordHasher\UserPasswordHasherInterface;</code>
			</p>
			<p class="info">Il faut penser √† sauvegarder par CTRL+S</p>
			<p>On peut maintenant lancer la commande
			<pre><code>sc d:f:l -n</code></pre>
			pour charger les fixtures et cr√©er l'utilisateur dans la base de donn√©es</p>
			<p class="info">Il est importnat de reconnaitre les erreurs par exemple dans notre cas ona SQLSTATE et ensuite on a une erreur mais Symfony nous guide par Did you forget ... Tu as pas oubli√© .., prendre le temps de lire ;-). Les deux ereurus qui suivent sont tr√®s fr√©quentes et facile √† rep√©rer.</p>
			<p class="warning">Si on a une erreru du genre de
				<code class="language-bash">
					An exception occurred while executing a query: SQLSTATE[HY000]: General error: 1 no such table: user
				</code>
				on doit v√©rifier que l'on a bien cr√©√© la table user dans la base de donn√©es, pour cela on peut faire
				<code>sc d:s:u -f</code>
			</p>
			<pre><code>sc d:f:l -n</code></pre>
			<p class="warning">On a encore une erreur
				<code class="language-bash">
					Attempted to load class "User" from namespace "App\DataFixtures".Did you forget a "use" statement for "App\Entity\User"?
				</code>
				et pour corriger l'erreur, on doit ajouter le use pour User et on sauvegarde, cela va nous ajouter
				<code>use App\Entity\User;</code>
			</p>
			<pre><code>sc d:f:l -n</code></pre>
			<p class="success">On a maintenant un utilisateur cr√©√© dans la base de donn√©es.</p>

			<div class="explanation">
				<h5>üîë Cr√©ation de la fixture UserFixtures</h5>
				<p>La commande
					<code>sc make:fixtures UserFixtures</code>
					g√©n√®re un fichier de base :
				</p>
				<ul>
					<li>
						<strong>Namespace :</strong>
						App\DataFixtures
					</li>
					<li>
						<strong>Classe :</strong>
						H√©rite de Fixture
					</li>
					<li>
						<strong>M√©thode load() :</strong>
						√Ä compl√©ter avec nos donn√©es
					</li>
				</ul>
				<p>
					<strong>But :</strong>
					Cr√©er des donn√©es de test automatiquement
				</p>
				<p>
					<strong>m√©thode persist()</strong>
					de l'ObjectManager: pour enregistrer les utilisateurs
				</p>
				<p>
					<strong>m√©thode flush()</strong>
					de l'ObjectManager: pour appliquer les changements
				</p>

				<p>On a souvent des boucles avec des persist dedans et apr√®s la boucle 1 flush, √ßa permet d'optimiser les performances.</p>
			</div>


			<h4>8. Configurer l'acc√®s aux routes</h4>
			<p>Dans
				<code>config/packages/security.yaml</code>, modifier la section access_control :
			</p>
			<pre><code class="language-yaml">access_control:
    - { path: ^/login, roles: PUBLIC_ACCESS }
    - { path: ^/home, roles: ROLE_USER }</code></pre>

			<p>
				<strong>Explication :</strong>
			</p>
			<ul>
				<li>
					<code>^/login</code>
					‚Üí accessible sans connexion, indispensable
				</li>
				<li>
					<code>^/home</code>
					‚Üí pour les utilisateurs connect√©s
				</li>
				<li>L'ordre est important (plus sp√©cifique en premier)</li>

			</ul>

			<div class="explanation">
				<h5>üîë Configuration des r√®gles d'acc√®s</h5>
				<p>
					<strong>access_control dans security.yaml :</strong>
				</p>
				<ul>
					<li>
						<code>^/login</code>
						‚Üí PUBLIC_ACCESS (accessible sans login)
					</li>
					<li>
						<code>^/</code>
						‚Üí ROLE_USER (toutes les autres routes prot√©g√©es)
					</li>

				</ul>
				<p>
					<strong>Effet :</strong>
					Redirection automatique vers /login si non connect√©
				</p>
			</div>
			<h4>9. Cr√©ation d'un HomeController avec une vue twig</h4>
			<pre><code>sc make:controller HomeController</code></pre>
			<p class="info">On r√©pond non √† la question pour cr√©er un fichier test (on a pas install√© les outils pour). Et comparer √† toute √† l'heure on va avoir des fichiers twigs qui vont √™tre cr√©√©s :</p>
			<ul>
				<li>
					<code>src/Controller/HomeController.php</code>
					- Contr√¥leur pour la page d'accueil
				</li>
				<li>
					<code>templates/home/index.html.twig</code>
					- Template Twig pour la vue
				</li>
				<li>
					<code>templates/base.html.twig</code>
					- Template de base Twig
				</li>
			</ul>
			<h4>10. Vider le cache et tester</h4>
			<pre><code class="language-bash">sc cache:clear</code></pre>
			<p>Cette commande vide le cache Symfony pour que les modifications de s√©curit√© soient prises en compte.</p>
			<p>
				<strong>Test de l'authentification :</strong>
			</p>
			<p>Acc√©der √†
				<code>http://localhost:8080/home</code>
			</p>
			<p class="info">‚úÖ Vous devriez √™tre redirig√© vers /login</p>
			<p>
				<strong>V√©rifications :</strong>
			</p>
			<ul>
				<li>URL change automatiquement pour /login</li>
				<li>Formulaire de connexion affich√©</li>
				<li>Champs email et password pr√©sents</li>
			</ul>
			<h4>10. Se connecter</h4>
			<p>
				<strong>Identifiants cr√©√©s par la fixture :</strong>
			</p>
			<ul>
				<li>
					<strong>Email :</strong>
					a@aa.aa
				</li>
				<li>
					<strong>Password :</strong>
					motdepasse
				</li>
			</ul>
			<p class="success">‚úÖ Authentification r√©ussie !</p>
			<p>Vous √™tes maintenant connect√© et pouvez acc√©der aux pages prot√©g√©es.</p>

			<h4>12. Installer la debugbar</h4>
			<pre><code>composer require --dev symfony/profiler-pack</code></pre>
			<p class="info">La debugbar permet de voir les requ√™tes, les routes, les entit√©s, les requ√™tes SQL...</p>
			<p>On peut la voir en bas de la page √† condition que tu ai pens√© √† vider le cache ;-)</p>
			<p class="info">Avant de continuer va jeter un coup d'oeil au HomeController et au deux fichiers de template. C'est important</p>
			<div class="explanation">
				<h5>üîß Debugbar Symfony</h5>
				<p>La debugbar affiche :</p>
				<ul>
					<li>
						<strong>Requ√™tes SQL :</strong>
						Toutes les requ√™tes ex√©cut√©es
					</li>
					<li>
						<strong>Routes :</strong>
						Routes utilis√©es dans la requ√™te
					</li>
					<li>
						<strong>Entit√©s :</strong>
						Donn√©es charg√©es depuis la base
					</li>
					<li>
						<strong>Performances :</strong>
						Temps d'ex√©cution
					</li>
					<li>
						<strong>Utilisateurs :</strong>
						Informations sur les utilisateurs connect√©s et possibilit√© de se d√©connecter
					</li>
				</ul>
				<br>
				<h5>le fichier Controller avec twig</h5>
				<p>Le fichier
					<code>src/Controller/HomeController.php</code>
					contient la logique pour afficher la page d'accueil :
				</p>
				<ul>
					<li>La m√©thode
						<code>index()</code>
						retourne le template
						<code>home/index.html.twig</code>
					</li>
					<li>Response: permet de renvoyer une r√©ponse HTTP avec le contenu du template, on peux renvoyer des fichiers, des jsons, des images ...</li>
					<li>Les param√®tres du twig: permettent de passer des variables au template, dans
						<code>
							return $this->render('home/index.html.twig', ['controller_name' => 'HomeController',]);</code>,on renvoie la variable
						<code>controller_name</code>, et on peut acc√©der √† ces variables dans le template avec
						<code>{{ controller_name }}</code>.
					</li>
				</ul>
			</div>
			<h4>13. D√©connexion</h4>
			<p>il suffit d'aller sur
				<code>http://localhost:8080/logout</code>
				pour se d√©connecter, on est redirig√© vers la page de login.
			</p>
			<p class="info">On voit dans la debugbar que l'on est d√©connect√©.</p>
		</div>

		<div id="part2" class="part">
			<h2>üé® Partie 2: Interface et tableaux interactifs</h2>
			<h3>üñºÔ∏è Configuration de l'interface</h3>
			<h4>1. Installer AssetMapper</h4>
			<pre><code>composer require symfony/asset-mapper</code></pre>
			<div class="explanation">
				<h5>‚öõÔ∏è Gestion des assets avec AssetMapper</h5>
				<p>AssetMapper est la nouvelle approche de Symfony pour g√©rer les assets (images, styles, scripts) :</p>
				<ul>
					<li>
						<strong>Pas de build step :</strong>
						Pas besoin de Webpack ou Vite
					</li>
					<li>
						<strong>ES6 modules :</strong>
						Support natif des modules JavaScript
					</li>
					<li>
						<strong>Import maps :</strong>
						R√©solution automatique des d√©pendances
					</li>
					<li>
						<strong>CSS modernes :</strong>
						Support des nouvelles fonctionnalit√©s CSS
					</li>
				</ul>
				<p>
					<strong>Avantage :</strong>
					Plus simple que les bundlers traditionnels, id√©al pour les projets sans build complexe
				</p>
				<p class="warning">Il y toujours le probl√®me de cache mais en plus un autre probl√®me se pose. Quand un fichier est modifi√©, il n'est pas toujours recharg√© automatiquement dans le navigateur. Pour √©viter d'avoir √† taper des commandes √† chaque fois que le twig,js... est modifi√©, il suffit de lancer dans un terminal la commande ./refresh.sh. C'est un script qui v√©rifie si il y a eu des modifs et mets √† jour les assets par la commande
					<code>sc asset-map:compile</code>
				</p>
				<p class="info">Asset mapper √† cr√©er des fichiers
				<ul>
					<li>
						<code>assets/</code>
						- Dossier pour les assets (images, styles, scripts)
					</li>
					<li>
						<code>public/assets/</code>
						- Dossier public pour les assets compil√©s
					</li>
					<li>
						<code>config/packages/asset_mapper.yaml</code>
						- Configuration de AssetMapper
					</li>
					<li>modifier le fichier
						<code>templates/base.html.twig</code>
						en ajoutant
						{% block importmap %}{{ importmap('app') }}
						qui automatiquement ins√®re les fichiers n√©cessaires.
					</li>
					<li>
						<code>importmap.php</code>
						qui contient les mappages des imports pour les fichiers JS et CSS.
					</li>
				</ul>
				</p>
				<p class="info">Jette un coup d'oeil dans les fichiers. ;-)</p>
			</div>
			<h4>2. Installer Bootstrap par importmap</h4>
			<pre><code>sc importmap:require bootstrap</code></pre>
			<p class="danger">Il est important de voir ce que notre import √† install√© dans notre cas bootstrap, @popperjs/core, bootstrap/dist/css/bootstrap.min.css, ces fichiers sont mis dans le r√©pertoire /vendor et sont compil√©s par asset mapper dans le dossier public en dev sous leur nom toto.js par exemple et en prod par toto6543.js par exemple pour que le navigateur change pense que c'est un nouveau fichier √† chaque fois que tu mets le site √† jour.</p>
			<p class="info">On veut utiliser bootstrap dans notre projet, notre fichier base.html.twig √† d√©j√†
				<code>{{importmap('app')}}</code>
				ce qui va nous permettre d'utiliser les imports dans notre fichier automatiquement
				<code>app.js</code>
			</p>
			<p>On va maintenant modifier le fichier
				<code>assets/app.js</code>
				pour importer Bootstrap et son css:
			</p>
			<pre><code class="language-js">import 'bootstrap';import 'bootstrap/dist/css/bootstrap.min.css';</code></pre>

			<p>Actualise ta page pour voir les changements.
			<pre><code>http://localhost:8080/home</code></pre>
			</p>

			<p class="success">‚úÖ Bootstrap est maintenant int√©gr√© !</p>
			<p>Tu peux maintenant utiliser les classes Bootstrap dans tes templates Twig.</p>
			<p class="info">Tu peux aussi utiliser les composants JavaScript de Bootstrap en ajoutant les data attributes n√©cessaires dans tes templates. Par exemple pour un tooltip :
				<code>data-bs-toggle="tooltip" data-bs-placement="top" title="Super Tooltip"</code>
				Essaie de le faire sur
				<code>templates/index.html.twig sur le h1</code>
				Actualise ta page et met ta souris sur le Hello Controller pour voir le tooltip.
			</p>
			<h4>3. Installer Stimulus</h4>
			<pre><code>composer require symfony/stimulus-bundle</code></pre>
			<div class="explanation">
				<h5>‚öõÔ∏è Framework JS minimal Stimulus</h5>
				<p>Stimulus est le framework JavaScript recommand√© par Symfony, ses principaux avantages sont :</p>
				<ul>
					<li>
						<strong>L√©ger :</strong>
						Pas de virtual DOM, manipulation directe du DOM
					</li>
					<li>
						<strong>Int√©gration facile :</strong>
						il suffit de mettre
						<code>data-controller="nom_du_controller"</code>
						sur l'√©l√©ment HTML √† contr√¥ler.
					</li>
					<li>
						<strong>Composants r√©utilisables :</strong>
						Facilit√© de cr√©ation de composants interactifs r√©utilisables.
					</li>
					<li>
						<strong>Organisation :</strong>
						Structure claire des fichiers et des dossiers. On met les contr√¥leurs Stimulus dans le dossier
						<code>assets/controllers</code>, et on peut cr√©er des r√©pertoires dedans et pour appeler un contr√¥leur dans le r√©pertoire tools on fait
						<code>data-controller="tools/nom_du_controller" data-target="tools--nom_du_controller"</code>.
					</li>
					<li>
						<strong>Utilisation de cible(target) de Stimulus :</strong>
						Permet de cibler des √©l√©ments sp√©cifiques dans le DOM pour les contr√¥leurs Stimulus.
					</li>
					<li>
						<strong>Principe :</strong>
						Ajouter des comportements interactifs sans r√©√©crire tout en JavaScript
					</li>
				</ul>
			</div>
			<h4>4. Cr√©er un une entity objet qui aura le nom de l'objet et son prix</h4>
			<pre><code>sc make:entity Produit</code></pre>
			<p class="info">On cr√©√© un champ nom
				<code>nom puis string de 255 caract√®res et on dit non quand il demande s'il peut √™tre vide (on oblige √† ce qu'il y ait un nom)</code>
				et un champ prix
				<code>prix puis integer (on parle toujours en centimes, les float sont dangereux) et on met nullable yes</code>
				et enter pour quitter. Va voir le fichier
				<code>src/Entity/Produit.php</code>
				et son Repository
				<code>src/Repository/ProduitRepository.php</code>
			</p>
			<p>On met √† jour la base de donn√©e avec la commande suivante :</p>
			<pre><code>sc d:s:c -f</code> pour que proiduit soit cr√©√© dedans</pre>
			<h4>4. des fixtures pour cr√©er des donn√©es de test</h4>
			<pre><code>sc make:fixtures ProductFixtures</code></pre>
			<p class="info">On un produit de test pour notre application, on ouvre le fichier
				<code>src/DataFixtures/ProductFixtures.php</code>
				et on ajoute des produits dans la m√©thode
				<code>load</code>. Je te laisse faire sachant que l'on a les m√©thodes pour modifier un objet produit dans le fichier de l'entit√© comme setNom. Quand tu as finis lance
				<code>sc d:f:l (on a pas mis le -n pour que tu vois le message d'avertissement que les donn√©es vont √™tre effac√©es)</code>
				pour charger les donn√©es de test dans la base de donn√©es.
			</p>
			<p class="warning">Tu peux lancer
			<pre><code>php bin/console doctrine:query:sql "SELECT * FROM produit"</code></pre>
			cela te permettra de voir tes produits dans la bd. C'est doctrine qui nous permet de lancer des commandes sql dans la bd directement ;-)</p>
			<div class="explanation">
				<h5>üîß il y a aussi la possibilit√© d'ajouter sans tout √©craser</h5>
				<pre><code>sc d:f:l --append</code></pre>
				<p class="info">
					Si tu veux regrouper tes fixtures et ne lancer qu'un groupe, si tu regardes l'aide par
					<code>sc d:f:l --help</code>
					il t'en parle, tu dois ajouter
					<code>sc d:f:l --group nom_du_groupe</code>
					<br>Tu dois mettre dans ton fichier fixture
					<code>implements FixtureGroupInterface</code>
					apr√®s extends Fixture, click droit import class ;-) puis cr√©√© une m√©thode getGroups qui retourne un array donc
				<pre><code>public static function getGroups():array
    {
        return ['nouveau'];
    }</code></pre>
				Maintenant tu peux lancer
				<code>sc d:f:l --group=nouveau</code>
				et il ne chargera que les fixtures de ce groupe donc userfixture ne sera pas mis dans la bd.
				Si tu veux ajouter en gardant toutes les fixtures d√©j√† mis
				<code>sc d:f:l --group=nouveau --append</code>
				</p>
			</div>
			<h4>5. Cr√©er des fakers de plusieurs products</h4>
			<p>On va utiliser le faker pour cr√©er des produits al√©atoires, on va modifier la m√©thode load de ProductFixtures pour ajouter des produits al√©atoires :</p>
			<pre><code class="language-php">public function load(ObjectManager $manager): void
{
	$faker = Factory::create();
	for ($i = 0; $i < 10; $i++) {
		$product = new Produit();
		$product->setNom($faker->word);
		$product->setPrix($faker->numberBetween(100, 10000)); // Prix entre 1‚Ç¨ et 100‚Ç¨
		$manager->persist($product);
	}
	$manager->flush();
}</code></pre>
			<p class="info">On utilise la librairie Faker pour g√©n√©rer des donn√©es al√©atoires, on peut l'installer avec la commande :</p>
			<pre><code>composer require --dev fakerphp/faker</code></pre>
			<p class="danger">Quand tu va faire un click droit import class sur
				<code>Factory</code>
				il va te proposer 2 librairies, cela arrive souvent, prend le temps de prendre la bonne. Si tu te trompes efface la ligne use ... qu'il a jout√© et recommence le click droit ;-)
			</p>
			<p class="info">On peut maintenant lancer
				<code>sc d:f:l --group=nouveau</code>
				pour charger les produits al√©atoires dans la base de donn√©es.
			</p>
			<p class="warning">Si tu v√©rifie tu verras que tu as perdu tes users
				<code></code>
				<code>php bin/console doctrine:query:sql "SELECT * FROM user"</code>
				et que tu as des produits al√©atoires dans la base de donn√©es
				<code>php bin/console doctrine:query:sql "SELECT * FROM produit"</code>
				Si tu veux garder les users et ajouter les produits al√©atoires, tu peux lancer la commande
				<code>sc d:f:l --group=nouveau --append</code>
				et avant si tu veux remettre toutes les autres fixtures
				<code>sc d:f:l -n</code>
			</p>
			<p class="success">Produits al√©atoires cr√©√©s !</p>
			<p>Tu peux maintenant utiliser ces produits dans ton application.</p>
			<h4>6. Affichage des produits par le Controller HomeController dans le twig index.html.twig</h4>
			<p>On va modifier le fichier
				<code>src/Controller/HomeController.php</code>
				pour r√©cup√©rer les produits depuis la base de donn√©es par le repository et les passer au template :
			</p>
			<pre><code class="language-php">
public function index(ProduitRepository $produitRepository): Response
	{
		$produits = $produitRepository->findAll();

		return $this->render('home/index.html.twig', [
			'produits' => $produits,
		]);
	}</code></pre>
			<p class="info">On va maintenant modifier le template (le block body)et ajouter une boucle car on re√ßois un tableau
				<code>templates/index.html.twig</code>
				pour afficher les produits :
			</p>
			<script type="text/plain" class="language-twig">
{% block body %}
	{% for produit in produits %}
		{{ produit.id }}
		{{ produit.nom }}
		{{ produit.prix }}
	{% endfor %}
{% endblock %}
</script>
			ou en liste
			<script type="text/plain" class="language-twig">
{% block body %}
	<ul>
		{% for produit in produits %}
			<li>{{ produit.id }} - {{ produit.nom }} - {{ produit.prix }}</li>
		{% endfor %}
	</ul>
{% endblock %}
			</script>
			ou en tableau bootstrap
			<script type="text/plain" class="language-twig">{% block body %}
<table class="table">
    <thead>
        <tr>
			<th>ID</th>
            <th>Nom</th>
            <th>Prix</th>
        </tr>
    </thead>
    <tbody>
        {% for produit in produits %}
            <tr>
				<td>{{ produit.id }}</td>
                <td>{{ produit.nom }}</td>
                <td>{{ produit.prix }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
 </script>

			<h4>7. On ajoute un bouton pour supprimer un produit</h4>
			<p>On ajoute une route pour supprimer le produit dans le controller</p>
			<pre><code class="language-php">#[Route('/delete/{id}', name: 'delete_produit')]
public function delete(Produit $produit, ObjectManager $manager): Response
	{
		$manager->remove($produit);
		$manager->flush();

		return $this->redirectToRoute('home');
	}</code></pre>
			<p class="info">On utilise l'injection de d√©pendance pour r√©cup√©rer le bon produit, c'est √† dire qu'en mettant/{id} et qu'on √† dit dans la m√©thode <code>delete(Produit ...)</code> doctrine comprend qu'on cherche un produit avec cet id. et on supprime le produit en utilisant la m√©thode <code>remove()</code> puis on fait un flush() pour appliquer les changements.</p>
			<p>On ajoute un bouton dans le twig pour supprimer le produit, pour cela on ajoute une collonne action au tr:</p>
			<p class="info">On se sert de EntityManagerInterface pour g√©rer les entit√©, les repository... alors qu'ObjetcManager dans les fixtures est plus g√©n√©rique. Nous partout on se sert de EntityManagerInerface ;-)</p>
			<script type="text/plain" class="language-twig"><th>Action</th>
			</script>
			<p>et on ajoute un bouton dans le td de la boucle</p>
			<script type="text/plain" class="language-twig">
<td>
	<form method="post" action="{{ path('delete_produit', {id: produit.id}) }}">
		<button type="submit" class="btn btn-danger">Supprimer</button>
	</form>
</td>
			</script>
			<p class="info">On utilise la m√©thode POST pour envoyer la requ√™te de suppression, on utilise la m√©thode path pour g√©n√©rer l'URL de la route delete_produit avec l'id du produit.</p>
			<p class="success">Bouton de suppression ajout√© !</p>
			<p>Tu peux maintenant supprimer des produits en cliquant sur le bouton.</p>
			<p class="danger">Tu va avoir une erreur <code>... "App\Controller\Produit". :Did you forget to add a use statement?</code>, normal tu n'as pas fait click droit->import Class</p>"
			<p class="danger">General error: 8 attempt to write a readonly database signifie qu'il faut faire un chmod 775 sur var/data_dev.db et chown www-data:www-data var/data_dev.db √† faire dans le docker</p>
			<p class="info">Une fois ces erreurs corrig√©es, tu peux supprimer par <code>http://localhost:8080/delete/18</code> par exemple, c'est un GET. Si on veut autoriser que POST on met dans la route
				<code>  #[Route('/delete/{id}', name: 'delete_produit', methods: ['POST'])]</code>

			<h4>8. Ajout d'un beau message par phpflasher</h4>
			<p>On va installer le bundle phpflasher pour afficher des messages de succ√®s, d'erreur...</p>
			<pre><code>composer require php-flasher/flasher-symfony</code></pre>, exceptionnellement on va aussi lancer une commande qui va l'installer dans public pour qu'il soit accessible sur le site car les pages webs ne peuvent acc√©der qu'√† public, les autres r√©pertoires sont innacessibles par le navigateur.</p>
			<pre><code>sc flasher:install</code></pre>
			<p class="info">On va ajouter le code suivant dans le Controller pour afficher un message de succ√®s apr√®s la suppression en utilisant l'injection pour avoir acc√®s √† flasher dans cette m√©thode:</p>
			<pre><code class="language-php">public function delete(Produit $produit, EntityManagerInterface $entityManager, FlasherInterface $flasher): </code></pre>
			<p class="info">On va ajouter le code suivant dans le Controller pour afficher un message de succ√®s apr√®s la suppression en utilisant l'injection pour avoir acc√®s √† flasher dans cette m√©thode:</p>
			<pre><code class="language-php">$flasher->success('Produit supprim√© avec succ√®s !');</code></pre>
			<p class="success">On peut informer l'utilisateur de ce qui se passe.</p>

			<h4>8. Ajouter un bouton + par bootstrap-icon pour ajouter une ligne vide au d√©but du tableau</h4>
			<h5>On ajoute bootstrap-icon</h5>
			<pre><code>sc importmap:require bootstrap-icons/font/bootstrap-icons.css</code></pre> puis on l'ajoute dans notre app.js
			<pre><code class="language-js">import 'bootstrap-icons/font/bootstrap-icons.css';</code></pre>
			<p class="info">On peut maintenant utiliser les ic√¥nes de bootstrap dans notre twig, par exemple pour changer supprimer par un icone de poubelle on met :</p>
			<script type="text/plain" class="language-twig">
		<button type="submit" class="btn btn-danger"><i class="bi bi-trash"></i></button>
			</script>
			<p class="info"> tu peux t'amuser √† changer d'icone, regarde sur le site <a href="https://icons.getbootstrap.com/">https://icons.getbootstrap.com/</a>" il y a un moteur de recherche ;-)</p>

			<h5>On ajoute un code stimulus qui va ajouter une ligne vide dans notre tableau juste en dessous de la ligne ou on clique. Pour cela on va cr√©er un code qui va cloner notre ligne et vider les 3 premi√®res collones</h5>
			<p>On va cr√©er un contr√¥leur Stimulus √† partir de rien ce sera plus simple. Cr√©√© un fichier
				<code>assets/controllers/produit_controller.js</code>
				et ajoute le code suivant qui ne fait rien, il dit juste que le stimulus est bien charg√© et qu'il est pr√™t √† √™tre utilis√© :
			</p>
			</p>
			<script type="text/plain" class="language-js">
import { Controller } from '@hotwired/stimulus';
export default class extends Controller {
	}
}
</script>
			<p>Pour chaque ligne dans notre index.html.twig on va ajouter le stimulus et une action pour le bouton + .</p>
			<p>On dit que c'est sur cette ligne que notre stimulus va travailler.</p>
			<script type="text/plain" class="language-twig">
{% block body %}
<tr data-controller="produit">
{% endblock %}
			</script>
			<p>et apr√®s le form on ajoute une action qui va lancer une fonctio ndans notre stimulus. Pour cela on met data-action et comme valeur le nom du stimulus et le nom de la function</p>
			<script type="text/plain" class="language-twig">
			<button data-action="produit#add" class="btn btn-primary">
							<i class="bi bi-plus-circle-fill"></i>
						</button>
				</script>
			<p class="info">Si on va sur la page web et que l'on fait click droit et inspecter on a Console en haut et quand on clique dessus on peut voir ce qui se passe en js et dans nos stimulus. Tu devrais voir pleins de <code>produit #initialize</code> et <code>produit #connect</code> (autant que le nombre de lignes ;-) )</p>

			<p>On cr√©√© un code pour notre stimulus le plus simple possible, on le met entre les {}</p>
			<script type="text/plain" class="language-js">
				 add() {
        const newline = this.element.cloneNode(true);
        newline.children[0].textContent = '';
        newline.children[1].textContent = '';
        newline.children[2].textContent = '';
        this.element.after(newline);
    }
</script>
			<p class="info">On donne le nom de la fonction add() et on met le code entre les {}, le code dit que l'on cr√©√© une ligne que l'on apelle newline qui est un clone de la ligne acteulle (this.element) et que l'on vide le contenu de ses 3 enfants qui sont les td, enfin on ajoute apr√®s la ligne (this.element) la nouvelle ligne (newline).</p>
			<p class="success">On a maintenant un bouton qui ajoute une ligne vide au d√©but du tableau.</p>
			<h5>On ajoute un bouton qui sauvegarde notre ligne</h5>
			<p>On va ajouter un bouton qui va sauvegarder la ligne dans la base de donn√©es, on va cr√©er un formulaire pour cela. On ajoute un formulaire dans notre index.html.twig juste apr√®s le bouton +</p>
			<script type="text/plain" class="language-twig">
				<button class="btn btn-success" data-action="produit#save">
					<i class="bi bi-save"></i>
				</button>
			</script>
			<p class="info">Si tu regerdes ce que cela donne, tu verras que les boutons sont les uns sous les autres, on arranger √ßa, dans leurs case on met <code>td class="d-flex p-0"</code> √† la place de <code>td</code></p>
			<h5>On va cr√©er une m√©thode save dans notre stimulus</h5>
			<p>On va ajouter une m√©thode save dans notre stimulus pour sauvegarder la ligne dans la base de donn√©es. On va utiliser fetch pour envoyer les donn√©es au serveur (√† notre Controller HomeController).</p>
			<p>On va ajouter le code suivant dans notre stimulus :</p>
			<script type="text/plain" class="language-js">
 save() {
        fetch('/save', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
           body: JSON.stringify({ id: this.element.children[0].textContent, nom: this.element.children[1].textContent, prix: this.element.children[2].textContent }),
        }).then(location.reload());
    }
</script>
			<p class="info">On utilise fetch pour envoyer une requ√™te POST √† notre l'url <code>save</code>, on envoie les √©l√©ments de la ligne (id, nom, prix) en JSON. On peut maintenant cr√©er la route dans notre Controller HomeController. La ligne <code>location.reload()</code> va actualiser la page web quand il a finis l'envoie et qu'il a re√ßu un retour.</p>
			<h5>On ajoute la route dans notre Controller HomeController :</h5>
			<pre><code class="language-php">#[Route('/save', name: 'save_produit', methods: ['POST'])]
public function save(ProduitRepository $produitRepository, ObjectManager $em, FlasherInterface $flasher, Request $request): Response
    {
        $data = json_decode($request->getContent(), true);
        $produit = new Produit();
        $produit->setNom($data['nom']);
        $produit->setPrix($data['prix']);
        $em->persist($produit);
        $em->flush();

        $flasher->success('Produit sauvegard√© avec succ√®s !');

        return new Response('Produit sauvegard√©', 200);
    }</code></pre>
			<p class="info">On r√©cup√®re les donn√©es envoy√©es par le stimulus, on cr√©e un nouvel objet Produit, on lui donne un nom et un prix, on le persiste et on le sauvegarde dans la base de donn√©es. On utilise aussi Flasher pour afficher un message de succ√®s.</p>
			<p class="warning">On a un probl√®me on ne peut pas modifier la case prix ou nom des ligne. Il suffit d'ajouter <code>contenteditable="true" dans les deux tds d'index.html.twig</code></p>
			<p class="warning">Si on modifie une ligne existante, on voit qu'il laisse l'ancienne et qu'il ajoute une nouvelle ligne. Le probl√®me vient du Controller, il faut v√©rifier si id est nulle, s'il est null, on est dans une cr√©ation d'une nouvelle ligne, sinon on est dans une modification d'une ligne existante. </p>
			<p>On va modifier notre Controller HomeController :</p>
			<pre><code class="language-php">        if($data['id'] != "") {
            $produit = $em->getRepository(Produit::class)->find($data['id']);
        }
        else {
            $produit = new Produit();
        }</code></pre> √† la place de <code>$produit = new Produit();</code>




		</div>







	</body>

</html>